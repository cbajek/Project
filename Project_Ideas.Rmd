---
title: "Project_Ideas"
author: "Jack Freier"
date: "10/29/2019"
output:
  html_document:
    keep_md: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r, include=FALSE, message=FALSE}
# Libraries
library(tidyverse)
library(ggplot2)
```


```{r}
# Read the data into R
Data = read.csv(file = 'MCM_NFLIS_Data.csv', header = FALSE)

# Create a data frame
DF = data.frame(Year = Data$V1,
                State = Data$V2,
                County = Data$V3,
                FIPS_State = Data$V4,
                FIPS_County = Data$V5,
                FIPS_Combined = Data$V6,
                Substance = Data$V7,
                Opioid_Reports = Data$V8,
                Total_Drug_Reports_County = Data$V9,
                Total_Drug_Reports_State = Data$V10)

# Extract relevant rows and reindex
DF = DF[-1,]
rownames(DF) = NULL

# Transform factors into numeric values
DF$Year = as.numeric(as.character(DF$Year))
DF$Opioid_Reports = as.numeric(as.character(DF$Opioid_Reports))
DF$Total_Drug_Reports_County = as.numeric(as.character(DF$Total_Drug_Reports_County))
DF$Total_Drug_Reports_State = as.numeric(as.character(DF$Total_Drug_Reports_State))

# Compute total opioid reports for each year and county
Annual_County <- DF %>%
  group_by(Year, FIPS_Combined) %>%
  summarize(Total_Opioid_Reports_County = sum(Opioid_Reports))

# Compute total opioid reports for each year and state
Annual_State <- DF %>%
  group_by(Year, FIPS_State) %>%
  summarize(Total_Opioid_Reports_State = sum(Opioid_Reports))

# Join opioid totals back to original dataset
DF <- DF %>%
  inner_join(Annual_County, by = c("Year", "FIPS_Combined")) %>%
  inner_join(Annual_State, by = c("Year", "FIPS_State"))

# Reorder Columns
DF <- DF[c(1,2,3,4,5,6,7,8,11,12,9,10)]
```


```{r}
# Create the first vizualization
DF %>%
  ggplot(aes(x = Year, y = Total_Opioid_Reports_State, color = State)) +
  geom_line(size = 1.25) +
  labs(x = "Year", y = "Total Opioid Reports") +
  ggtitle("Annual Opioid Reports by State") +
  scale_x_continuous(breaks = c(seq(2010, 2017, 1)), limits = c(2010, 2017)) +
  scale_y_continuous(breaks = c(seq(0, 50000, 5000)), limits = c(0, 50000)) +
  theme_light()
```

```{r}
# Create Second Visualization
# Still need to improve this obvi
DF %>% 
  ggplot(aes(x=Year,y=Total_Opioid_Reports_State)) +
  geom_col() +
  facet_wrap(~Substance)
```

